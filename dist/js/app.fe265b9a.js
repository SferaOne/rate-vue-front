(function(t){function e(e){for(var s,n,o=e[0],c=e[1],l=e[2],d=0,_=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&_.push(i[n][0]),i[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(_.length)_.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],s=!0,n=1;n<a.length;n++){var c=a[n];0!==i[c]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var s={},i={app:0},r=[];function n(t){return o.p+"js/"+({}[t]||t)+"."+{"chunk-652f06e9":"abb4db7f"}[t]+".js"}function o(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(t){var e=[],a=i[t];if(0!==a)if(a)e.push(a[2]);else{var s=new Promise((function(e,s){a=i[t]=[e,s]}));e.push(a[2]=s);var r,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=n(t);var l=new Error;r=function(e){c.onerror=c.onload=null,clearTimeout(d);var a=i[t];if(0!==a){if(a){var s=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",l.name="ChunkLoadError",l.type=s,l.request=r,a[1](l)}i[t]=void 0}};var d=setTimeout((function(){r({type:"timeout",target:c})}),12e4);c.onerror=c.onload=r,document.head.appendChild(c)}return Promise.all(e)},o.m=t,o.c=s,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(a,s,function(e){return t[e]}.bind(null,s));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("85ec")},"049e":function(t,e,a){"use strict";a("625e")},1552:function(t,e,a){},1740:function(t,e,a){"use strict";a("f8b9")},"1a76":function(t,e,a){},"1f01":function(t,e,a){"use strict";a("b939")},"309a":function(t,e,a){"use strict";a("56bd")},3427:function(t,e,a){},4375:function(t,e,a){},"51fc":function(t,e,a){},"56bd":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-main",[a("notifications",{staticClass:"mt-notify",attrs:{position:"top right",width:"25%"}}),a("v-dialog",{staticClass:"mt-editor-form",attrs:{persistent:"","hide-overlay":"",transition:"dialog-bottom-transition",width:"60%",height:"60%"},on:{"click:outside":function(e){t.showshipschedule=!1}},model:{value:t.showshipschedule,callback:function(e){t.showshipschedule=e},expression:"showshipschedule"}},[a("RateCardShipSchedule",{attrs:{rate:t.current_rate},on:{close:function(e){t.showshipschedule=!1},save:t.OnSave}})],1),a("router-view")],1),t.is_show_request_button?a("div",{staticClass:"help-button"},[a("v-btn",{staticClass:"mx-2",attrs:{rounded:"",dark:"",large:"",color:"primary"},on:{click:t.help}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-help ")]),t._v("Запрос ставки ")],1)],1):t._e(),t.is_show_exit_button?a("div",{staticClass:"exit-button"},[a("v-btn",{staticClass:"mx-2",attrs:{rounded:"",dark:"",large:"",color:"primary"},on:{click:t.exit}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-logout ")]),t._v("Выход ")],1)],1):t._e()],1)},r=[],n=(a("b0c0"),a("ac1f"),a("5319"),a("d3b7"),a("ddb0"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mt-editor-form"},[a("h3",{staticClass:"block-header"},[t._v("Расписание судов: "+t._s(t.rate.title))]),a("table",{staticClass:"schedule-table"},[t._m(0),t._l(t.schedule,(function(e){return a("tr",{key:e.id,staticClass:"rate-card-detail-service"},[a("td",{staticClass:"td-center"},[t._v(t._s(e.place_from_name)+"("+t._s(e.point_from_name)+")")]),a("td",{staticClass:"td-center"},[t._v(t._s(e.place_to_name)+"("+t._s(e.point_to_name)+")")]),a("td",{staticClass:"td-center"},[t._v(t._s(e.transporter_name))]),a("td",{staticClass:"td-right"},[t._v(t._s(e.vassel_name))]),a("td",{staticClass:"td-center"},[t._v(t._s(t.getdate(e.sea_start_date)))]),a("td",{staticClass:"td-center"},[t._v(t._s(t.getdate(e.sea_end_date)))]),a("td",{staticClass:"td-right"},[t._v(t._s(e.empty_place_count)),e.empty_place_count>0?a("span",[t._v(" мест")]):t._e()])])}))],2)])}),o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"schedule-table-head"},[a("tr",[a("td",{staticClass:"td-center"},[t._v("Место отправки")]),a("td",{staticClass:"td-center"},[t._v("Место доставки")]),a("td",{staticClass:"td-center"},[t._v("Перевозчик/линия")]),a("td",{staticClass:"td-center"},[t._v("Наименование судна")]),a("td",{staticClass:"td-center"},[t._v("Дата выхода в море")]),a("td",{staticClass:"td-center"},[t._v("Дата прихода в порт")]),a("td",{staticClass:"td-center"},[t._v("Количество мест")])])])}],c=new s["default"],l={name:"RateCardSchedule",props:{rate:{type:Object}},components:{},data:function(){return{schedule:[]}},mounted:function(){this.getShipScheduleByKey()},watch:{rate:{handler:function(){this.getShipScheduleByKey()},deep:!0}},methods:{getShipScheduleByKey:function(){var t=this;this.$postapi(this.$address+this.$getters.getShipScheduleByKey.uri,{method:this.$getters.getShipScheduleByKey.name,key:this.rate.key_orig,on_date:this.rate.on_date,unit_type:this.rate.unit_type}).then((function(e){0==e.error?t.schedule=JSON.parse(e.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,")):c.$emit("show_notify",{color:"error",notifytext:e.message})}))},getdate:function(t){return null!=t?new Date(t).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric",timezone:"UTC"}):" "}}},d=l,u=(a("6afd"),a("2877")),_=Object(u["a"])(d,n,o,!1,null,"5650ae51",null),m=_.exports,h={appName:"Erzus Logistic App",address:"http://localhost:8000",productionTip:!1,key:"",localstorage:window.localStorage,config:{}},p={getRateList:{uri:"/rate/list/"},getReferenceData:{uri:"/reference/data/"},getRateByKey:{uri:"/rate/key/"},getShipScheduleByKey:{uri:"/ship/schedule/key/"},getAdditionalExpensesByKey:{uri:"/additional/expenses/key/"}},f={auth:{uri:"/auth/login"},check:{uri:"/auth/check"},validate:{uri:"/loader/validate"}},v={name:"App",components:{RateCardShipSchedule:m},data:function(){return{goto:void 0,authData:{},popupVisible:!1,showshipschedule:!1,current_rate:{},is_show_request_button:!1,is_show_exit_button:!1}},mounted:function(){var t=this;this.$_config={headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Allow-Methods":"*",Authorization:this.$_getsetting("token")}},this.is_show_exit_button=1==this.$_getsetting("show_exit_button"),c.$on("show_notify",(function(e){t.show_notify(e)})),c.$on("show_exit_button",(function(){t.is_show_exit_button=1==t.$_getsetting("show_exit_button")})),c.$on("show_popup",(function(){alert("Show popup")})),c.$on("show_schedule",(function(e){t.current_rate=e,t.openSchedule()})),void 0!=this.goto?this.$router.push(void 0!=this.goto?this.goto:this.check()):(alert(this.$route.name),"RateCardByID"!=this.$route.name&&"RateLoader"!=this.$route.name&&this.check())},methods:{check:function(){var t=this;this.$getapi(h.address+f.check.uri+"/"+this.$_getsetting("token")).then((function(e){if(0==e.error){var a=JSON.parse(e.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));t.$_setsetting("token",a.token),t.$router.push(a.route)}else t.exit()}))},help:function(){this.popupVisible=!0},exit:function(){this.$_removesetting("token"),this.$_removesetting("show_exit_button"),this.$router.push("/"),this.is_show_exit_button=!1},openSchedule:function(){this.showshipschedule=!0},show_notify:function(t){this.$notify({title:'<p class="mt-notify-title">Внимание</p>',text:'<p class="mt-notify-text">'+t.notifytext+"</p>",type:t.color,ignoreDuplicates:!0})},OnSave:function(t){var e=this;this.$postapi(this.$address+this.$setters[t.values.method].uri,t.values).then((function(t){0==t.error?c.$emit("show_notify",{color:"success",notifytext:"Создано обращение с номером "+t.message}):c.$emit("show_notify",{color:"error",notifytext:t.message}),e.popupVisible=!1,e.showsendraterequestform=!1}))}}},g=v,b=(a("034f"),a("6544")),y=a.n(b),k=a("7496"),C=a("8336"),x=a("169a"),w=a("132d"),S=a("f6c4"),$=Object(u["a"])(g,i,r,!1,null,null,null),O=$.exports;y()($,{VApp:k["a"],VBtn:C["a"],VDialog:x["a"],VIcon:w["a"],VMain:S["a"]});var R=a("f309");s["default"].use(R["a"]);var A=new R["a"]({lang:{current:"ru"}}),D=a("bc3a"),T=a.n(D),I=a("8c4f"),L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rate-page-container"},[1==t.showloader?a("div",{staticClass:"rate-loader-block"},[a("v-progress-circular",{attrs:{size:100,width:10,color:"primary",indeterminate:""}})],1):t._e(),a("div",{}),a("div",{staticClass:"rate-worked-block"},[a("div",{staticClass:"rate-parameters"},[a("RateParameters",{attrs:{cid:parseInt(t.cid)}})],1),t.is_not_found?a("div",{staticClass:"rate-card-list-container"},t._l(t.ratelist,(function(t){return a("div",{key:t.id},[a("RateCard",{attrs:{rate:t}})],1)})),0):a("div",{staticClass:"rate-card-list-container"},[a("RateCardNotFound",{attrs:{parameters:t.params}})],1),a("div",{staticClass:"rate-advanced-parameters"},[a("RateAdvancedParameters",{attrs:{baseparams:t.baseparams}})],1)])])},j=[],z=(a("4e827"),a("1276"),a("d81d"),a("c740"),a("caad"),a("2532"),a("4de4"),{methods:{checkAll:function(t,e){return 1!=parseInt(t.is_direct)?this.checkAllWithPorts(t,e):this.checkAllWithOutPorts(t,e)},checkAllWithOutPorts:function(t,e){return!!this.checkSumma(t,e.price_limit)&&(!!this.checkIsSea(t,e.is_not_sea)&&(!!this.checkIsLackOfEmptyEquipment(t,e.is_lack_of_empty_equipment_date)&&(!!this.checkIsSoc(t,e.is_soc)&&(!!this.checkStation(t,e.selected_station)&&(!!this.checkTransporter(t,e.selected_contractor)&&(!!this.checkIsDirect(t,e.is_direct)&&(!!this.checkSeaWeeks(t,e.selected_sea_start_weeks)||void 0)))))))},checkAllWithPorts:function(t,e){return!!this.checkSumma(t,e.price_limit)&&(!!this.checkIsSea(t,e.is_not_sea)&&(!!this.checkIsLackOfEmptyEquipment(t,e.is_lack_of_empty_equipment_date)&&(!!this.checkIsSoc(t,e.is_soc)&&(!!this.checkPort(t,e.selected_port)&&(!!this.checkStation(t,e.selected_station)&&(!!this.checkTransporter(t,e.selected_contractor)&&(!!this.checkIsDirect(t,e.is_direct)&&(!!this.checkSeaWeeks(t,e.selected_sea_start_weeks)||void 0))))))))},checkSumma:function(t,e){return t.total<=e},checkIsSea:function(t,e){return e.includes(t.is_sea)},checkIsSoc:function(t,e){return e.includes(parseInt(t.is_soc))},checkPort:function(t,e){return e.includes(t.terminal_id)},checkStation:function(t,e){return e.includes(t.station_id)},checkTransporter:function(t,e){return e.includes(t.line_id)},checkTranzitTime:function(t,e){return t.tranzit_time<=e},checkIsLackOfEmptyEquipment:function(t,e){return e.includes(t.lack_of_empty_equipment_type)},checkIsDirect:function(t,e){return e.includes(parseInt(t.is_direct))},checkSeaWeeks:function(t,e){var a=t.sea_start_weeks.split(","),s=a.filter((function(t){return e.includes(t)}));return s.length>0}}}),E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rate-parameters-container"},[a("span",[t._v("Параметры запроса...")]),a("div",{staticClass:"rate-params"},[a("v-autocomplete",{attrs:{disabled:t.isUpdating,items:t.places_from,"small-chips":"",flat:"",clearable:"",label:"Место отправки","item-text":"name","item-value":"id"},scopedSlots:t._u([{key:"item",fn:function(e){return["object"!==typeof e.item?[a("v-list-item-content",{domProps:{textContent:t._s(e.item)}})]:[a("v-list-item-content",[a("v-list-item-title",{domProps:{innerHTML:t._s(e.item.name)}}),a("v-list-item-subtitle",{domProps:{innerHTML:t._s(e.item.country)}})],1)]]}}]),model:{value:t.place_from,callback:function(e){t.place_from=e},expression:"place_from"}})],1),a("div",{staticClass:"rate-params"},[a("v-autocomplete",{staticClass:"param-field",attrs:{disabled:t.isUpdating,items:t.places_to,"small-chips":"",flat:"",clearable:"",label:"Мeсто доставки","item-text":"name","item-value":"id"},scopedSlots:t._u([{key:"item",fn:function(e){return["object"!==typeof e.item?[a("v-list-item-content",{domProps:{textContent:t._s(e.item)}})]:[a("v-list-item-content",[a("v-list-item-title",{domProps:{innerHTML:t._s(e.item.name)}}),a("v-list-item-subtitle",{domProps:{innerHTML:t._s(e.item.country)}})],1)]]}}]),model:{value:t.place_to,callback:function(e){t.place_to=e},expression:"place_to"}}),a("v-autocomplete",{staticClass:"param-field",attrs:{disabled:t.isUpdating,items:t.unit_codes,"small-chips":"",flat:"",clearable:"",label:"Оборудование","item-text":"name","item-value":"id"},scopedSlots:t._u([{key:"item",fn:function(e){return["object"!==typeof e.item?[a("v-list-item-content",{domProps:{textContent:t._s(e.item)}})]:[a("v-list-item-content",[a("v-list-item-title",{domProps:{innerHTML:t._s(e.item.name)}}),a("v-list-item-subtitle",{domProps:{innerHTML:t._s(e.item.descr)}})],1)]]}}]),model:{value:t.unit_code,callback:function(e){t.unit_code=e},expression:"unit_code"}})],1),a("div",{staticClass:"rate-params"},[a("v-menu",{ref:"menu1",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-text-field",t._g(t._b({attrs:{label:"Дата готовности груза",flat:"","persistent-hint":""},on:{blur:function(e){t.on_date=t.parseDate(t.dateFormatted)}},model:{value:t.dateFormatted,callback:function(e){t.dateFormatted=e},expression:"dateFormatted"}},"v-text-field",i,!1),s))]}}]),model:{value:t.menu1,callback:function(e){t.menu1=e},expression:"menu1"}},[a("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.on_date,callback:function(e){t.on_date=e},expression:"on_date"}})],1),a("v-btn",{staticClass:"rate-search-button",attrs:{rounded:"",large:"",color:"primary"},on:{click:t.search}},[a("v-icon",[t._v(" mdi-search-web ")]),t._v(" Найти варианты ")],1)],1)])},P=[],q=a("3835"),V=(a("a9e3"),a("a434"),a("99af"),a("4d90"),{name:"RateParameters.vue",props:{cid:{type:Number}},data:function(t){return{unit_code:[],autoUpdate:!0,place_from:[],place_to:[],isUpdating:!1,places_from:[],places_to:[],unit_codes:[],country_from:null,country_to:[],countryes_from:[],countryes_to:[],fltr_places_from:[],fltr_places_to:[],on_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),dateFormatted:t.formatDate(new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)),menu1:!1,show_change_client:0}},computed:{computedDateFormatted:function(){return this.formatDate(this.on_date)}},watch:{isUpdating:function(t){var e=this;t&&setTimeout((function(){return e.isUpdating=!1}),3e3)},on_date:function(){this.dateFormatted=this.formatDate(this.on_date)}},mounted:function(){this.show_change_client=this.$_getsetting("show_change_client"),this.getreferencedata("countryfrom"),this.getreferencedata("countryto"),this.getreferencedata("placefrom"),this.getreferencedata("placeto"),this.getreferencedata("unitcode")},methods:{getreferencedata:function(t){var e=this;this.$getapi(this.$address+this.$getters.getReferenceData.uri+t).then((function(a){if(0==a.error)switch(t){case"placefrom":e.places_from=JSON.parse(a.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));break;case"placeto":e.places_to=JSON.parse(a.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,")),e.returnplacetoreference();break;case"countryto":e.countryes_to=JSON.parse(a.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));break;case"countryfrom":e.countryes_from=JSON.parse(a.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));break;case"unitcode":e.unit_codes=JSON.parse(a.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));break;case"clientvdrefclients":e.clients=JSON.parse(a.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));break}else c.$emit("show_notify",{color:"error",notifytext:a.message})}))},remove:function(t,e){switch(e){case 0:var a=this.place_from.indexOf(t.id);a>=0&&this.place_from.splice(a,1);break;case 1:var s=this.unit_code.indexOf(t.id);s>=0&&this.unit_code.splice(s,1);break;case 2:var i=this.place_to.indexOf(t.id);i>=0&&this.place_to.splice(i,1)}},formatDate:function(t){if(!t)return null;var e=t.split("-"),a=Object(q["a"])(e,3),s=a[0],i=a[1],r=a[2];return"".concat(r,".").concat(i,".").concat(s)},parseDate:function(t){if(!t)return null;var e=t.split("."),a=Object(q["a"])(e,3),s=a[0],i=a[1],r=a[2];return"".concat(r,"-").concat(i.padStart(2,"0"),"-").concat(s.padStart(2,"0"))},search:function(){c.$emit("getratelist",{place_from:this.place_from,place_to:this.place_to,unit_code:this.unit_code,on_date:this.on_date})},returnplacefromreference:function(){if(this.fltr_places_from=[],null!=this.country_from)for(var t=0;t<this.places_from.length;t++)this.places_from[t].country_id==this.country_from&&this.fltr_places_from.push({id:this.places_from[t].id,name:this.places_from[t].name,country:this.places_from[t].country_name});else this.fltr_places_from=this.places_from},filterplacefrom:function(){this.returnplacefromreference()},returnplacetoreference:function(){if(this.fltr_places_to=[],null!=this.country_to)for(var t=0;t<this.places_to.length;t++)this.places_to[t].country_id==this.country_to&&this.fltr_places_to.push({id:this.places_to[t].id,name:this.places_to[t].name,country:this.places_from[t].country_name});else this.fltr_places_to=this.places_to},filterplaceto:function(){this.returnplacetoreference()}}}),N=V,B=(a("cd67"),a("c6a6")),F=a("2e4b"),M=a("5d23"),U=a("e449"),J=a("8654"),K=Object(u["a"])(N,E,P,!1,null,"1e682b08",null),H=K.exports;y()(K,{VAutocomplete:B["a"],VBtn:C["a"],VDatePicker:F["a"],VIcon:w["a"],VListItemContent:M["a"],VListItemSubtitle:M["b"],VListItemTitle:M["c"],VMenu:U["a"],VTextField:J["a"]});var W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return 1==t.rate.is_visible?a("div",{staticClass:"rate-card-conteiner",class:{rate_active:t.active_id==t.rate.id},attrs:{id:t.rate.id}},[a("div",{staticClass:"rate-card-short-title"},[a("div",{staticClass:"rate-card-short-title-main"},[a("div",{staticClass:"rate-card-short-caption"},[t._v(" "+t._s(t.rate.title)+" ")]),a("div",{staticClass:"rate-card-short-cost-total"},[t._v(" "+t._s(t.getnumber(t.rate.total))+" ₽ ")])]),a("div",{staticClass:"rate-card-short-title-sub"},[a("div",{staticClass:"rate-card-short-title-sub-info"},[a("div",[t._v(" Перевозчик: "+t._s(t.rate.line_name)+"  ")]),a("div",[t._v(" Терминал: "+t._s(0==t.rate.is_direct?t.rate.terminal_name:1==t.rate.is_ete?t.rate.across_place_name_ext:"")+"  ")]),a("div",[t._v(" Порт отправки: "+t._s(t.rate.base_place_from_name_ext.length>0?t.rate.base_place_from_name_ext:t.rate.base_place_from_name)+"  ")]),a("div",[t._v("  "+t._s(1==t.rate.is_ete?"Сквозной сервис":"")+"  ")])]),a("div",{staticClass:"rate-card-short-cost-total-sub"},[t._v(" "+t._s(t.getnumber(t.rate.usd_total))+" $ ")])])]),a("div",{staticClass:"rate-card-block"},[a("div",{staticClass:"rate-card-infoblock"},[a("RateCardDetail",{attrs:{rate:t.rate}})],1),a("div",{staticClass:"rate-card-cost"},[a("div",{staticClass:"rate-card-cost-raiting"},[a("img",{attrs:{src:"stars/"+t.rate.raiting+".png"}})]),a("div",{staticClass:"rate-card-lack-of-empty-equipment"},[a("img",{attrs:{src:t.getlackimg(t.rate),alt:t.getLackDescription(),title:t.getLackDescription()}}),1==t.rate.is_prebook?a("img",{attrs:{src:"green.png",alt:"Есть места на судне. Подробности по расписанию...",title:"Есть места на судне. Подробности по расписанию..."}}):t._e()]),a("div",{staticClass:"rate-card-cost-container"},[a("div",{staticClass:"rate-card-unit"},[t._v(" "+t._s(t.rate.delivery_term_code)+" ")]),a("div",{staticClass:"rate-card-unit"},[t._v(" "+t._s(t.rate.unit_code)+" ")])])])]),a("div",{staticClass:"rate-card-actions"},[a("div",{staticClass:"toggle-button-right",on:{click:function(e){return t.openSchedule(t.rate)}}},[t._v(" Расписание ")]),a("div",{class:t.getToggleButtonClass(!1),on:{click:function(e){return t.openrateview(t.rate.key_orig,t.rate.on_date)}}},[t._v(" Подробности ")])])]):t._e()},X=[],Z=(a("fb6a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-detail-data"},[a("table",{staticClass:"rate-card-detail-table"},[t._m(0),t._l(t.rate.detail,(function(e){return a("tr",{key:e.id,staticClass:"rate-card-detail-service"},[a("td",[a("img",{staticClass:"rate-card-service-img",attrs:{alt:e.service,title:e.service,src:t.getimage(e)}})]),a("td",[t._v(t._s(t.createchain(e,0)))]),a("td",[t._v(t._s(t.createchain(e,1)))]),a("td",{staticClass:"td-center"},[t._v(t._s(t.getnumber(e.summa))+"  "),"USD"==e.cur_code?a("span",[t._v("$")]):a("span",[t._v("₽")])]),a("td",{staticClass:"td-center"},[t._v(t._s(t.getnumber(e.cost))+" ₽")])])}))],2)])}),G=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticStyle:{"font-weight":"bold","text-align":"left"}},[a("td",{staticClass:"td-center"},[t._v("Этап")]),a("td",[t._v("Место отправки")]),a("td",[t._v("Место прибытия")]),a("td",{staticClass:"td-center"},[t._v("Стоимость, вал")]),a("td",{staticClass:"td-center"},[t._v("Стоимость, ₽")])])])}],Q={name:"RateCardDetail.vue",props:{rate:{type:Object}},data:function(){return{active:null}},methods:{getnumber:function(t){return parseFloat(t).toLocaleString("ru-RU")},getcurrencysign:function(t){return"USD"==t?"<span>&#36;</span>":"&#8381;"},isFloat:function(t){return t===+t&&t!==(0|t)},createchain:function(t,e){return 259==t.type_id?t.place_from:0==e?t.place_from+(t.ext_place_from.length>0?" ("+t.ext_place_from+")":""):t.place_to+(t.ext_place_to.length>0?" ("+t.ext_place_to+")":"")},getimage:function(t){return t.icon}}},Y=Q,tt=(a("f1b8"),Object(u["a"])(Y,Z,G,!1,null,"2c7e5b8a",null)),et=tt.exports,at={name:"RateCard.vue",props:{rate:{type:Object}},components:{RateCardDetail:et},data:function(){return{active_id:0,active_short_id:0,is_mark:!1}},mounted:function(){var t=this;c.$on("collapse_card",(function(e){e.is_group&&t.rate.id==e.id&&(t.active_short_id=e.id),e.is_group&&0==e.id&&(t.active_short_id=0)})),c.$on("mark_card",(function(e){t.rate.is_visible&&e.is_mark?(t.is_mark=e.is_mark,t.pushtoarray(t.rate)):(t.is_mark=!1,t.pushtoarray(t.rate))}))},methods:{pushtoarray:function(t){c.$emit("pushtogroup",{id:t.id,key:t.key_orig,is_mark:this.is_mark})},opencard:function(t){this.active_id=this.active_id==t?0:t},openshortcardview:function(t){this.active_id=0,this.active_short_id=this.active_short_id==t?0:t},baycard:function(t){c.$emit("show_send_request",{rate:t})},getnumber:function(t){return parseFloat(t).toLocaleString("ru-RU")},isFloat:function(t){return t===+t&&t!==(0|t)},createchain:function(t,e){return 0==e?t.place_from+(t.ext_place_from.length>0?"("+t.ext_place_from+")":""):t.place_to+(t.ext_place_to.length>0?"("+t.ext_place_to+")":"")},getimage:function(t){switch(t.type_id){case 215:return"1.png";case 519:case 952:case 214:return"2.png";case 259:return"3.png";case 213:return"4.png"}},getspeedimage:function(t){return t?"speed.png":""},getmoneyimage:function(t){return t?"money.png":""},openrateview:function(t,e){var a=this.$router.resolve({path:"/RateCardByID",query:{key:t,on_date:e}});window.open(a.href,"_blank")},crop:function(t){return t.slice(0,7)+"..."},getraitingImage:function(t){return t+".png"},getlackimg:function(t){return 0!=t.lack_of_empty_equipment_type?"/"+t.lack_of_empty_equipment_img:"blue.png"},openSchedule:function(t){c.$emit("show_schedule",t)},getScheduleButtonClass:function(t){return"schedule-button margin-left-20"},getToggleButtonClass:function(t){return 1==t?"toggle-button margin-left-20":"toggle-button margin-left-60"},getdate:function(t){return null!=t?new Date(t).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric",timezone:"UTC"}):" "},getLackDescription:function(){switch(this.rate.lack_of_empty_equipment_type){case 0:return this.rate.is_lack_of_empty_equipment_date_desc;case 1:return this.rate.is_lack_of_empty_equipment_date_desc+"\r\nОриентировочный срок появления "+this.getdate(this.rate.lack_of_empty_equipment_date);case 2:return this.rate.is_lack_of_empty_equipment_date_desc+"\r\nИнформация отстутсвует с "+this.getdate(this.rate.lack_of_empty_equipment_date)}},getColoredClass:function(t){switch(t.lack_of_empty_equipment_type){case 0:return 1!=t.is_prebook?"background-no-limits":"background-no-limits-prebook";case 1:return 1!=t.is_prebook?"background-not-equipment":"background-not-equipment-prebook";case 2:return 1!=t.is_prebook?"background-need-info":"background-need-info-prebook"}},getTitleClass:function(t){return 0!=t?"title-red":""},getTitleIconClass:function(t){return 0!=t?"title-red":"title-green"}}},st=at,it=(a("900e"),Object(u["a"])(st,W,X,!1,null,"3d159488",null)),rt=it.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rate-adv-parameters-container"},[a("div",{staticClass:"adv-panel-transform"},[a("span",{staticClass:"adv-panel-header"},[t._v("Фильтр...")]),a("div",{staticClass:"customs-price-calculator-slider"},[a("div",{staticClass:"customs-price-slider-label"},[a("div",{},[t._v(" "+t._s(t.ex1.label)+" ")]),a("div",{staticClass:"customs-price-slider-value"},[t._v(" до "+t._s(t.getnumber(t.ex1.val))+"  ₽ ")])]),a("v-slider",{staticClass:"adv-param-slider",attrs:{color:t.ex1.color,"track-color":"#6c8693",min:t.ex1.min,max:t.ex1.max},on:{change:t.estimation},model:{value:t.ex1.val,callback:function(e){t.$set(t.ex1,"val",e)},expression:"ex1.val"}})],1),a("div",{staticClass:"customs-price-calculator-slider"},[a("div",{staticClass:"customs-price-slider-label"},[a("div",{staticClass:"adv-checkbox-label"},[t._v(" Исключить море ")]),a("div",{staticClass:"customs-price-slider-value"},[a("v-checkbox",{on:{click:t.estimation},model:{value:t.is_not_sea,callback:function(e){t.is_not_sea=e},expression:"is_not_sea"}})],1)])]),a("div",{staticClass:"customs-price-calculator-slider"},[a("div",{staticClass:"customs-price-slider-label"},[a("div",{staticClass:"adv-checkbox-label"},[t._v(" Исключить прямые поезда ")]),a("div",{staticClass:"customs-price-slider-value"},[a("v-checkbox",{on:{click:t.estimation},model:{value:t.is_direct,callback:function(e){t.is_direct=e},expression:"is_direct"}})],1)])]),a("div",{staticClass:"customs-price-calculator-slider"},[a("div",{staticClass:"customs-price-slider-label"},[a("v-radio-group",{attrs:{row:""},on:{change:t.OnRadioChange},model:{value:t.coc_soc,callback:function(e){t.coc_soc=e},expression:"coc_soc"}},[a("v-radio",{attrs:{label:"Все",value:"0"}}),a("v-radio",{attrs:{label:"COC",value:"1"}}),a("v-radio",{attrs:{label:"SOC",value:"2"}})],1)],1)])])])},ot=[],ct={name:"RateAdvancedParameters.vue",props:{baseparams:{type:Object}},watch:{baseparams:function(t){this.ex1={label:"Стоимость",val:this.price_val==t.maxprice||0==this.price_val?t.maxprice:this.price_val,color:"#a7c2d3",min:t.minprice,max:t.maxprice},this.ex2={label:"Ориентировочное транзитное время",val:this.tz_val==t.maxtztime||0==this.tz_val?t.maxtztime:this.tz_val,color:"#a7c2d3",min:t.mintztime,max:t.maxtztime},this.ports=t.ports,this.stations=t.stations,this.contractors=t.contractors,this.sea_start_weeks=t.sea_start_weeks,0==this.selected_ports.length&&this.getkeys(this.ports,this.selected_ports,this.unselected_ports,"id"),0==this.selected_stations.length&&this.getkeys(this.stations,this.selected_stations,this.unselected_stations,"id"),0==this.selected_contractors.length&&this.getkeys(this.contractors,this.selected_contractors,this.unselected_contractors,"id"),0==this.selected_sea_start_weeks.length&&this.getkeys(this.sea_start_weeks,this.selected_sea_start_weeks,this.unselected_contractors,"id")}},data:function(t){return{ex1:{label:"Стоимость",val:t.baseparams.maxprice,color:"#a7c2d3",min:t.baseparams.minprice,max:t.baseparams.maxprice},ex2:{label:"Ориентировочное транзитное время",val:t.baseparams.maxtztime,color:"#a7c2d3",min:t.baseparams.mintztime,max:t.baseparams.maxtztime},is_direct:!1,is_not_sea:!1,is_lack_of_empty_equipment_date:!1,selected_ports:[],ports:[],selected_stations:[],stations:[],selected_contractors:[],contractors:[],price_val:0,tz_val:0,coc_soc:0,is_soc:[0,1],sea_start_weeks:[],selected_sea_start_weeks:[]}},methods:{resetselected:function(){this.selected_contractors=[],this.selected_stations=[],this.selected_ports=[],this.selected_ports=[],this.selected_sea_start_weeks=[]},getarrdifirence:function(t,e){for(var a=[],s=0;s<t.length;s++)e.includes(t[s].id)||a.push(t[s].id);return a},estimation:function(){this.tz_val=this.ex2.val,this.price_val=this.ex1.val,c.$emit("filterratelist",{price_limit:this.price_val,tz_limit:this.tz_val,is_direct:this.getDirect(),is_not_sea:this.getNotSea(),selected_port:this.selected_ports,selected_station:this.selected_stations,selected_contractor:this.selected_contractors,selected_sea_start_weeks:this.selected_sea_start_weeks,is_soc:this.is_soc,is_lack_of_empty_equipment_date:this.getLackOfEmptyEquipment()})},OnRadioChange:function(){switch(parseInt(this.coc_soc)){case 0:this.is_soc=[0,1];break;case 1:this.is_soc=[0];break;case 2:this.is_soc=[1];break}this.estimation()},getLackOfEmptyEquipment:function(){return this.is_lack_of_empty_equipment_date?[0,0]:[1,0,1,2]},getDirect:function(){return this.is_direct?[0,0]:[1,0,1]},getNotSea:function(){return this.is_not_sea?[0,0]:[1,0,1,2]},getnumber:function(t){return parseFloat(t).toLocaleString("ru-RU")},getkeys:function(t,e,a,s){if(null!=t)for(var i=0;i<t.length;i++)1==t[i].is_visible&&(e.includes(t[i][s])||e.push(t[i][s]))}}},lt=ct,dt=(a("6e83"),a("ac7c")),ut=a("67b6"),_t=a("43a6"),mt=a("ba0d"),ht=Object(u["a"])(lt,nt,ot,!1,null,"a31c1652",null),pt=ht.exports;y()(ht,{VCheckbox:dt["a"],VRadio:ut["a"],VRadioGroup:_t["a"],VSlider:mt["a"]});var ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rate-not-found-page"},[a("div",{staticClass:"rate-not-found-img"},[a("v-img",{attrs:{src:"not-found-icon-24.jpg"}})],1),a("div",{staticClass:"rate-not-found-text"},[t._v(" По данному запросу ничего не найдено... ")]),a("div",[a("v-btn",{attrs:{rounded:"",large:"",color:"primary"},on:{click:t.createRateRequest}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-help ")]),t._v("Разместить завку на котировку")],1)],1)])},vt=[],gt={name:"RateCardNotFound.vue",props:{parameters:{type:Object}},data:function(){return{}},methods:{createRateRequest:function(){c.$emit("show_popup")}}},bt=gt,yt=(a("9cfb"),a("adda")),kt=Object(u["a"])(bt,ft,vt,!1,null,"567db4a4",null),Ct=kt.exports;y()(kt,{VBtn:C["a"],VIcon:w["a"],VImg:yt["a"]});var xt={name:"RateList.vue",components:{RateParameters:H,RateCard:rt,RateAdvancedParameters:pt,RateCardNotFound:Ct},data:function(){return{ratelist:[],baseparams:{},cid:null,ports:[],stations:[],contractors:[],sea_start_weeks:[],showloader:0,params:void 0,is_not_found:!0,checkArrCount:0}},mounted:function(){var t=this;c.$on("sortrates",(function(e){t.sortrates(e.type)})),c.$on("getratelist",(function(e){t.getdata(e)})),c.$on("filterratelist",(function(e){t.filterdata(e)})),this.cid=this.$_getsetting("client_id")},methods:{getdata:function(t){var e=this;if(1==this.checkParameters(t)){this.params=t,this.showloader=1;var a=new Date(t.on_date);a.setDate(a.getDate()+4),this.$getapi(this.$address+this.$getters.getRateList.uri+t.on_date+"/"+t.place_from+"/"+t.place_to+"/"+t.unit_code).then((function(t){0==t.error?(e.ratelist=JSON.parse(t.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,")),e.checkpage(),e.sortrates(0),e.getstartparams(),e.getadvpairs(),e.showloader=0):c.$emit("show_notify",{color:"error",notifytext:t.message})}))}else c.$emit("show_notify",{color:"error",notifytext:"Указаны не все параметры для поиска!"})},checkParameters:function(t){return null!=t.on_date&&t.place_to.length>0&&t.place_from.length>0&&t.unit_code.length>0},sortrates:function(t){switch(t){case 0:this.ratelist.sort((function(t,e){return t.total-e.total}));break;case 1:this.ratelist.sort((function(t,e){return t.tranzit_time-e.tranzit_time}));break}},getstartparams:function(t){this.baseparams={minprice:this.getminprice(),maxprice:this.getmaxprice(),mintztime:this.getmintztime(),maxtztime:this.getmaxtztime(),ports:this.ports,stations:this.stations,contractors:this.contractors,sea_start_weeks:this.sea_start_weeks}},resetfilters:function(){this.ports=[],this.stations=[],this.contractors=[],this.sea_start_weeks=[]},getadvpairs:function(){if(null!=this.ratelist)for(var t=0;t<this.ratelist.length;t++)1!=this.ratelist[t].is_direct&&this.add(this.ports,{name:this.ratelist[t].terminal_name,id:this.ratelist[t].terminal_id,is_visible:this.ratelist[t].is_visible}),this.add(this.stations,{name:this.ratelist[t].station_name,id:this.ratelist[t].station_id,is_visible:this.ratelist[t].is_visible}),this.add(this.contractors,{name:this.ratelist[t].line_name,id:this.ratelist[t].line_id,is_visible:this.ratelist[t].is_visible}),this.parseSeaStartWeeks(this.ratelist[t])},parseSeaStartWeeks:function(t){for(var e=t.sea_start_weeks.split(","),a=0;a<e.length;a++)this.add(this.sea_start_weeks,{name:0!=parseInt(e[a])?e[a]+"-я неделя":"Выходы отсутсвуют",id:e[a],is_visible:t.is_visible})},filterdata:function(t){if(null!=this.ratelist){for(var e=0;e<this.ratelist.length;e++)this.ratelist[e].is_visible=1,this.checkvisible(t,this.ratelist[e])?this.ratelist[e].is_visible=1:this.ratelist[e].is_visible=0;this.resetfilters(),this.getadvpairs(),this.getstartparams(),this.checkFilterResult()}},checkvisible:function(t,e){return z.methods.checkAll(e,t)},getminprice:function(){var t=this.ratelist.map((function(t){return t.total}));return Math.min.apply(null,t)},getmaxprice:function(){var t=this.ratelist.map((function(t){return t.total}));return Math.max.apply(null,t)},getmintztime:function(){var t=this.ratelist.map((function(t){return t.tranzit_time}));return Math.min.apply(null,t)},getmaxtztime:function(){var t=this.ratelist.map((function(t){return t.tranzit_time}));return Math.max.apply(null,t)},add:function(t,e){if(null!=e&&null!=e.name&&e.name.length>0){var a=t.findIndex((function(t){return t.id===e.id}));a<0&&t.push(e)}},checkpage:function(){this.is_not_found=this.ratelist.length>0&&void 0!=this.params},getListCount:function(){this.checkArrCount=0;for(var t=0;t<this.ratelist.length;t++)if(1==this.ratelist[t].is_visible){this.checkArrCount=1;break}},checkFilterResult:function(){this.getListCount(),this.is_not_found=!(0==this.checkArrCount)}}},wt=xt,St=(a("049e"),a("490a")),$t=Object(u["a"])(wt,L,j,!1,null,"68d9efef",null),Ot=$t.exports;y()($t,{VProgressCircular:St["a"]});var Rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("RatePageCard",{attrs:{rate:t.rate}}),a("ShipScheduleTable",{attrs:{items:t.schedule}}),a("AdditionalStorageTable",{attrs:{items:t.additional.detention,header:"Сверхнормативное использование контейнера"}}),a("AdditionalStorageTable",{attrs:{items:t.additional.port_storage,header:"Хранение в порту прибытия"}}),a("AdditionalServiceTable",{attrs:{items:t.additional.port_additional,header:"Дополнительные услуги в порту прибытия"}}),a("AdditionalStorageTable",{attrs:{items:t.additional.station_storage,header:"Хранение на станции прибытия"}}),a("AdditionalServiceTable",{attrs:{items:t.additional.station_additional,header:"Дополнительные услуги на станции прибытия"}})],1)},At=[],Dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rate-page-card-conteiner",attrs:{id:"rate.id"}},[a("div",{staticClass:"rate-page-card-block"},[a("div",{staticClass:"rate-page-card-infoblock"},[a("div",{staticClass:"rate-page-card-title"},[t._v(" "+t._s(t.rate.title)+" ")]),a("div",{staticClass:"rate-page-card-short-title-sub"},[a("div",{staticClass:"rate-page-card-short-title-sub-info"},[a("div",[t._v(" Перевозчик: "+t._s(t.rate.line_name)+"  ")]),a("div",[t._v(" Терминал: "+t._s(0==t.rate.is_direct?t.rate.terminal_name:1==t.rate.is_ete?t.rate.across_place_name_ext:"")+"  ")]),a("div",[t._v(" Порт отправки: "+t._s(t.rate.base_place_from_name_ext.length>0?t.rate.base_place_from_name_ext:t.rate.base_place_from_name)+"  ")]),a("div",[t._v("  "+t._s(1==t.rate.is_ete?"Сквозной сервис":"")+"  ")])])]),a("RatePageDetailTable",{attrs:{items:t.rate.detail}}),a("div",{staticClass:"rate-path-info"},[a("div",{staticClass:"rate-path-container"},[a("div",{staticClass:"rate-path-left-conteiner"},[a("div",{staticClass:"rate-tranzit-header text-left"},[t._v(" Ставка действительна до "+t._s(t.actions.getDate(t.rate.date_to))+" ")]),a("div",{staticClass:"rate-tranzit-header text-left tomato"},[t._v(" Автодоставка в стоимость не включена! ")]),a("div",{staticClass:"rate-tranzit-header text-left tomato"},[t._v(" Место пересечения границы "+t._s(t.rate.place_across_name)+" ("+t._s(0==t.rate.is_direct?t.rate.terminal_name:1==t.rate.is_ete?t.rate.across_place_name_ext:"")+" ) ")])])])])],1),a("div",{staticClass:"rate-card-cost"},[a("div",{staticClass:"rate-card-cost-container"},[a("div",{staticClass:"rate-card-unit"},[t._v(" "+t._s(t.rate.delivery_term_code)+" ")]),a("div",{staticClass:"rate-card-unit"},[t._v(" "+t._s(t.rate.unit_code)+" ")]),a("div",{staticClass:"rate-card-cost-total"},[t._v(" "+t._s(t.actions.getNumber(t.rate.total))+" ₽ ")]),t.rate.total!=t.rate.usd_total?a("div",{staticClass:"rate-card-usd-cost-total"},[t._v(" "+t._s(t.actions.getNumber(t.rate.usd_total))+" $ ")]):t._e()])])])])},Tt=[],It={getNumber:function(t){return parseFloat(t).toLocaleString("ru-RU")},getDate:function(t){return null!=t?new Date(t).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric",timezone:"UTC"}):" "},getImage:function(t){return t.icon},CreateChain:function(t,e){return 0==e?t.place_from+(t.ext_place_from.length>0?"("+t.ext_place_from+")":""):t.place_to+(t.ext_place_to.length>0?"("+t.ext_place_to+")":"")},formatItem:function(t){return 0!=t.days_from?999!=t.days_to?"c "+t.days_from+" по "+t.days_to+" день, всего дней "+(t.days_to-t.days_from):"cвыше "+t.days_from+" дней":" по "+t.days_to+" день, всего дней "+(t.days_to-t.days_from)}},Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("table",{staticClass:"rate-page-detail-table"},[t._m(0),t._l(t.items,(function(e){return a("tr",{key:e.id,staticClass:"rate-page-detail-service"},[a("td",[a("img",{staticClass:"rate-page-service-img",attrs:{src:t.actions.getImage(e)}})]),a("td",[t._v(t._s(e.service))]),a("td",[t._v(t._s(t.actions.CreateChain(e,0)))]),a("td",[t._v(t._s(t.actions.CreateChain(e,1)))]),a("td",{staticClass:"td-right"},[t._v(" "+t._s(t.actions.getNumber(e.summa))+"  "),"USD"==e.cur_code?a("span",[t._v("$")]):a("span",[t._v("₽")])]),a("td",{staticClass:"td-right"},[t._v(t._s(t.actions.getNumber(e.cost))+" ₽")])])}))],2)])},jt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticStyle:{"font-weight":"bold","text-align":"left"}},[a("td",{attrs:{colspan:"2"}},[t._v("Этап")]),a("td",[t._v("Место отправки")]),a("td",[t._v("Место прибытия")]),a("td",{staticClass:"td-right"},[t._v("Стоимость, вал")]),a("td",{staticClass:"td-right"},[t._v("Стоимость, ₽")])])])}],zt={name:"RatePageDetailTable.vue",props:{items:{type:Array}},data:function(){return{actions:It}}},Et=zt,Pt=(a("e49a"),Object(u["a"])(Et,Lt,jt,!1,null,"55a4293f",null)),qt=Pt.exports,Vt={name:"RatePageCard.vue",props:{rate:{type:Object}},components:{RatePageDetailTable:qt},data:function(){return{actions:It}},methods:{}},Nt=Vt,Bt=(a("309a"),Object(u["a"])(Nt,Dt,Tt,!1,null,"d465f776",null)),Ft=Bt.exports,Mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.items.length>0?a("div",[a("h3",{staticClass:"block-header"},[t._v("Расписание судов:")]),a("table",{staticClass:"ship-schedule-table"},[t._m(0),t._l(t.items,(function(e){return a("tr",{key:e.id,staticClass:"rate-card-detail-service"},[a("td",{staticClass:"td-center"},[t._v(t._s(e.place_from_name)+"("+t._s(e.point_from_name)+")")]),a("td",{staticClass:"td-center"},[t._v(t._s(e.place_to_name)+"("+t._s(e.point_to_name)+")")]),a("td",{staticClass:"td-center"},[t._v(t._s(e.transporter_name))]),a("td",{staticClass:"td-right"},[t._v(t._s(e.vassel_name))]),a("td",{staticClass:"td-center"},[t._v(t._s(t.actions.getDate(e.sea_start_date)))]),a("td",{staticClass:"td-center"},[t._v(t._s(t.actions.getDate(e.sea_end_date)))])])}))],2)]):t._e()},Ut=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"schedule-table-head"},[a("tr",{staticStyle:{"font-weight":"bold"}},[a("td",{staticClass:"td-center"},[t._v("Место отправки")]),a("td",{staticClass:"td-center"},[t._v("Место доставки")]),a("td",{staticClass:"td-center"},[t._v("Подрядчик")]),a("td",{staticClass:"td-right"},[t._v("Наименование судна")]),a("td",{staticClass:"td-center"},[t._v("Дата выхода в море")]),a("td",{staticClass:"td-center"},[t._v("Дата прихода в порт")])])])}],Jt={getDate:function(t){return null!=t?new Date(t).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric",timezone:"UTC"}):" "}},Kt={name:"ShipScheduleTable.vue",props:{items:{type:Array}},data:function(){return{actions:Jt}}},Ht=Kt,Wt=(a("f2d4"),Object(u["a"])(Ht,Mt,Ut,!1,null,"52c4141c",null)),Xt=Wt.exports,Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.items.length>0?a("div",[a("h3",{staticClass:"block-header"},[t._v(t._s(t.header)+":")]),a("div",{staticClass:"additional-items-container"},t._l(t.items,(function(t){return a("div",{key:t.id},[a("AdditionalTableItem",{attrs:{item:t}})],1)})),0)]):t._e()},Gt=[],Qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"additional-item-row"},[a("div",{staticClass:"additional-item-comment"},[a("h4",[t._v(t._s(t.item.comment))])]),a("div",{staticClass:"additional-item-description"},[t._v(t._s(t.actions.formatItem(t.item)))]),a("div",{staticClass:"additional-item-price"},[t._v(t._s(t.actions.getNumber(t.item.price))+"  "),"840"==t.item.currency_id?a("span",[t._v("$")]):a("span",[t._v("₽")])])])},Yt=[],te={name:"AdditionalTableItem.vue",props:{item:{type:Object}},data:function(){return{actions:It}}},ee=te,ae=(a("f325"),Object(u["a"])(ee,Qt,Yt,!1,null,"1aa15278",null)),se=ae.exports,ie={name:"AdditionalTable.vue",props:{items:{type:Array},header:{type:String}},components:{AdditionalTableItem:se}},re=ie,ne=(a("1f01"),Object(u["a"])(re,Zt,Gt,!1,null,"1778ab44",null)),oe=ne.exports,ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.items.length>0?a("div",[a("h3",{staticClass:"block-header"},[t._v(t._s(t.header)+":")]),a("div",{staticClass:"additional-items-container"},t._l(t.items,(function(t){return a("div",{key:t.id},[a("AdditionalTableItem",{attrs:{item:t}})],1)})),0)]):t._e()},le=[],de=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"additional-item-row"},[a("div",{staticClass:"additional-item-name"},[t._v(t._s(t.item.obj_name))]),a("div",{staticClass:"additional-item-price"},[t._v(t._s(t.actions.getNumber(t.item.price))+"  "),"840"==t.item.currency_id?a("span",[t._v("$")]):a("span",[t._v("₽")])])])},ue=[],_e={name:"AdditionalTableItem.vue",props:{item:{type:Object}},data:function(){return{actions:It}}},me=_e,he=(a("f37c"),Object(u["a"])(me,de,ue,!1,null,"25541fdc",null)),pe=he.exports,fe={name:"AdditionalTable.vue",props:{items:{type:Array},header:{type:String}},components:{AdditionalTableItem:pe}},ve=fe,ge=(a("b7ad"),Object(u["a"])(ve,ce,le,!1,null,"de136d04",null)),be=ge.exports,ye={name:"RateCardByID",components:{AdditionalStorageTable:oe,AdditionalServiceTable:be,ShipScheduleTable:Xt,RatePageCard:Ft},data:function(){return{key:0,on_date:"",cid:-1,rate:{},additional:{detention:[],port_storage:[],port_additional:[],station_storage:[],station_additional:[]},settingsFormShow:!1,detention_comment:"",port_storage_comment:"",station_storage_comment:"",schedule:[]}},created:function(){this.key=this.$route.query.key,this.on_date=this.$route.query.on_date,this.getratebyid()},methods:{getratebyid:function(){var t=this;this.$getapi(this.$address+this.$getters.getRateByKey.uri+this.key+"/"+this.on_date).then((function(e){0==e.error?(t.rate=JSON.parse(e.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"))[0],t.getAdditionalExpensesRate(),t.getShipScheduleByKey()):c.$emit("show_notify",{color:"error",notifytext:e.message})}))},getAdditionalExpensesRate:function(){var t=this;this.$getapi(this.$address+this.$getters.getAdditionalExpensesByKey.uri+this.key+"/"+this.on_date).then((function(e){0==e.error?(t.additional=JSON.parse(e.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,")),t.getAdditionalHeaders(t.additional.detention),t.getAdditionalHeaders(t.additional.port_storage),t.getAdditionalHeaders(t.additional.station_storage)):c.$emit("show_notify",{color:"error",notifytext:e.message})}))},getAdditionalHeaders:function(t){for(var e=0;e<t.length;e++)if(0!=t[e].comment.length){switch(t[e].service_id){case 1039:this.detention_comment=t[e].comment.toLowerCase();break;case 1040:this.port_storage_comment=t[e].comment.toLowerCase();break;case 1041:this.station_storage_comment=t[e].comment.toLowerCase();break;default:break}if(0!=t[e].comment)break}},getShipScheduleByKey:function(){var t=this;this.$getapi(this.$address+this.$getters.getShipScheduleByKey.uri+this.key+"/"+this.on_date).then((function(e){0==e.error?t.schedule=JSON.parse(e.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,")):c.$emit("show_notify",{color:"error",notifytext:e.message})}))}}},ke=ye,Ce=(a("da5d"),Object(u["a"])(ke,Rt,At,!1,null,"3384c64f",null)),xe=Ce.exports,we=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mt-lcontainer"},[a("div",{staticClass:"mt-left-container"},[a("div",{staticClass:"mt-left-top-conteiner"}),a("div",[a("v-img",{staticClass:"mt-logo",attrs:{src:""}})],1)]),a("div",{staticClass:"mt-right-container"},[a("div",{staticClass:"mt-right-top-conteiner"}),a("div",{staticClass:"mt-right-bottom-container"},[a("v-text-field",{attrs:{label:"Логин","clear-icon":"mdi-close-circle",rules:[t.rules.login_required,t.rules.login_match,t.rules.login_counter]},model:{value:t.login,callback:function(e){t.login=e},expression:"login"}}),a("v-text-field",{attrs:{label:"Пароль","clear-icon":"mdi-close-circle","append-icon":t.show_pass?"mdi-eye":"mdi-eye-off",type:t.show_pass?"text":"password",rules:[t.rules.pass_required,t.rules.pass_match,t.rules.pass_counter]},on:{"click:append":function(e){t.show_pass=!t.show_pass}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("div",[a("v-btn",{attrs:{rounded:"",large:"",dark:"",color:"primary"},on:{click:function(e){return t.onLogin()}}},[t._v("Войти")])],1)],1)])])},Se=[],$e={methods:{get:function(t,e){return T.a.get(t,e).then((function(t){return t.data})).catch((function(t){return t}))},post:function(t,e,a){return T.a.post(t+"/",e,a).then((function(t){return t.data})).catch((function(t){return t}))}}},Oe=(a("25f0"),a("6821")),Re=a.n(Oe),Ae={methods:{mixed:function(t,e,a){return a.substr(0,5)+e.substr(24)+t.substr(5,8)+e.substr(8,8)+t.substr(21,8)+e.substr(0,8)+t.substr(13,8)+e.substr(16,8)+a.substr(5)},getepoch:function(){return Math.round((new Date).getTime()/1e3)},gethex:function(t){return t.toString(16)},getmixed:function(t,e,a){return this.mixed(Re()(t),Re()(e),this.gethex(a))}}},De={methods:{set:function(t,e){window.localStorage.setItem(t,e)},get:function(t){return window.localStorage.getItem(t)},clear:function(){window.localStorage.clear()},remove:function(t){window.localStorage.removeItem(t)}}},Te={actions:{auth:function(t,e){var a=Ae.methods.getepoch();$e.methods.post(h.address+f.auth.uri,{user:t,key:a,mixed:Ae.methods.getmixed(t,e,a)}).then((function(t){if(0==t.error){var e=JSON.parse(t.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));De.methods.set("token",e.token),c.$emit("changeLocation",e)}else De.methods.remove("token")}))},check:function(){$e.methods.get(h.address+f.check.uri+"/"+De.methods.get("token")).then((function(t){if(0==t.error){var e=JSON.parse(t.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));De.methods.set("token",e.token),c.$emit("changeLocation",e)}else De.methods.remove("token"),De.methods.remove("client_id"),De.methods.remove("email")}))}}},Ie=(a("00b4"),{login_required:function(t){return!!t||"Вы не указали логин..."},login_counter:function(t){return t.length>=3||"Длина не менее 3 символов"},login_match:function(t){var e=/^[0-9a-zA-Z]+$/;return e.test(t)||"Длина не менее 3 символов, цифры и буквы латинского алфавита..."},pass_required:function(t){return!!t||"Вы не указали пароль..."},pass_counter:function(t){return t.length>=5||"Длина не менее 5 символов"},pass_match:function(t){var e=/^[0-9a-zA-Z{},.<>;:$*!?^]+$/;return e.test(t)||"Длина не менее 5 символов, цифры, символы и буквы латинского алфавита..."}}),Le={name:"RateLogin.vue",data:function(){return{show_pass:!1,login:"",password:"",rules:Ie,actions:Te.actions}},mounted:function(){var t=this;this.onCheck(),c.$on("changeLocation",(function(e){t.$router.push(e.route)}))},methods:{onLogin:function(){this.actions.auth(this.login,this.password)},onCheck:function(){this.actions.check()}}},je=Le,ze=(a("1740"),Object(u["a"])(je,we,Se,!1,null,"77d7f221",null)),Ee=ze.exports;y()(ze,{VBtn:C["a"],VImg:yt["a"],VTextField:J["a"]});var Pe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-file-input",{attrs:{"truncate-length":"15"},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}}),a("v-btn",{attrs:{rounded:"",large:"",dark:"",color:"primary"},on:{click:function(e){return t.sendData()}}},[t._v("Send")]),a("xlsx-read",{attrs:{file:t.files}},[a("xlsx-table",{staticClass:"none-visible",attrs:{sheet:t.selectedSheet}}),a("xlsx-json",{attrs:{sheet:t.selectedSheet},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.collection;return[a("div",[t._v(" "+t._s(t.jsontogrid(s))+" ")])]}}])})],1)],1)},qe=[],Ve=a("cc08"),Ne=a("538c"),Be=a("a6b7"),Fe={headers:{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Allow-Methods":"*",Authorization:De.methods.get("token")}},actions:{send:function(t){console.log(this.headers),console.log(t),$e.methods.post(h.address+f.validate.uri,{data:t},this.headers).then((function(t){if(0==t.error){var e=JSON.parse(t.message.replace(/:"f",/gm,":false,").replace(/:"t",/gm,":true,"));console.log(e)}else console.log("Error")}))}}},Me={name:"RateLoader.vue",components:{XlsxRead:Ve["a"],XlsxTable:Be["a"],XlsxJson:Ne["a"]},data:function(){return{dataSource:{},file:null,files:[],selectedSheet:0,sheets:[],collection:[],actions:Fe.actions}},methods:{jsontogrid:function(t){this.dataSource=t},sendData:function(){this.actions.send(this.dataSource)}}},Ue=Me,Je=a("23a7"),Ke=Object(u["a"])(Ue,Pe,qe,!1,null,"8c0cee64",null),He=Ke.exports;y()(Ke,{VBtn:C["a"],VFileInput:Je["a"]}),s["default"].use(I["a"]);var We=new I["a"]({mode:"history",base:"/",routes:[{path:"/",name:"RateLogin",component:Ee},{path:"/RateList",name:"RateList",component:Ot},{path:"/RateCardByID",name:"RateCardByID",component:xe},{path:"/RateLoader",name:"RateLoader",component:He}],scrollBehavior:function(){document.getElementById("app").scrollIntoView()}}),Xe={ClientVDRefList:{name:"clnt_vd_ref_company",items:[]},ClientVDRefDeliveryTerms:{name:"clnt_vd_ref_delivery_terms",items:[]},ClientVDRefUnitTypes:{name:"lgst_cont_types",items:[]},LgstPlaceFrom:{name:"lgst_place_from",items:[]},LgstPlaceTo:{name:"lgst_place_to",items:[]}},Ze=a("ee98"),Ge=a.n(Ze),Qe=a("2992");s["default"].use(Ge.a),s["default"].$http=T.a,s["default"].prototype.$appName=h.appName,s["default"].prototype.$address=h.address,s["default"].config.productionTip=h.productionTip,s["default"].prototype.$key=h.key,s["default"].prototype.$getters=p,s["default"].prototype.$setters=f,s["default"].prototype.$references=Xe,s["default"].prototype.$_config={},s["default"].prototype.$getapi=$e.methods.get,s["default"].prototype.$postapi=$e.methods.post,s["default"].prototype.$_setsetting=De.methods.set,s["default"].prototype.$_getsetting=De.methods.get,s["default"].prototype.$_clear=De.methods.clear,s["default"].prototype.$_removesetting=De.methods.remove,new s["default"]({vuetify:A,render:function(t){return t(O)},lang:{locales:{ru:Qe.default},current:"ru"},router:We}).$mount("#app")},"625e":function(t,e,a){},"6afd":function(t,e,a){"use strict";a("af8d")},"6e83":function(t,e,a){"use strict";a("8b95")},"85ec":function(t,e,a){},"860b":function(t,e,a){},"8b95":function(t,e,a){},"900e":function(t,e,a){"use strict";a("e627")},"9cfb":function(t,e,a){"use strict";a("1552")},af8d:function(t,e,a){},b7ad:function(t,e,a){"use strict";a("1a76")},b939:function(t,e,a){},c29a:function(t,e,a){},cd67:function(t,e,a){"use strict";a("51fc")},d1b0:function(t,e,a){},da5d:function(t,e,a){"use strict";a("4375")},e49a:function(t,e,a){"use strict";a("860b")},e627:function(t,e,a){},e87b:function(t,e,a){},f1b8:function(t,e,a){"use strict";a("d1b0")},f2d4:function(t,e,a){"use strict";a("e87b")},f325:function(t,e,a){"use strict";a("3427")},f37c:function(t,e,a){"use strict";a("c29a")},f8b9:function(t,e,a){}});
//# sourceMappingURL=app.fe265b9a.js.map